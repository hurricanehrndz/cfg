# vim:set ft=zsh sw=2 sts=2 ts=2 et:

# see: https://wiki.archlinux.org/index.php/XDG_Base_Directory
# Home clean-up:
export XDG_CONFIG_HOME="$HOME/.config"
export XDG_DATA_HOME="$HOME/.local/share"
export XDG_CACHE_HOME="$HOME/.cache"

if [ -z "$XDG_GREETER_DATA_DIR" ] && [ -e "/etc/zsh/zprofile" ]; then
  # No duplicates in path arrays
  typeset -gU cdpath fpath mailpath PATH path
  # Source default profile if not done by system config
  grep -qc 'source /etc/profile' /etc/zsh/zprofile || \
    emulate sh -c 'source /etc/profile'
  path=(               \
    "$path[@]"         \
  )
  export PATH
else
  # Fallback for bash
  export PATH=$(echo "$PATH" | \
    awk -v RS=':' -v ORS=":" '!a[$1]++{if (NR > 1) printf ORS; printf $a[$1]}')
fi

# Time format
export TIME="\t%e real,\t%U user,\t%S sys"

# Default Programs
if [ -n "$(command -v alacritty)" ]; then
  export TERMINAL="alacritty"
fi

# Default editor (will set zsh binds to vi mode)
if [ -n "$(command -v nvim)" ]; then
  export EDITOR="nvim"
  export VISUAL="nvim"
else
  export EDITOR="vi"
  export VISUAL="vi"
fi

# Pagers
# less: do not pollute home
export LESSHISTFILE="-"
if [ -n "$(command -v bat)" ]; then
  alias cat='bat'
  export PAGER="bat"
  export MANPAGER="sh -c 'col -bx | bat -l man -p'"
  export BAT_THEME="TwoDark"
  export BAT_PAGER="less -RFI"
else
  # less options
  export LESS="-R-j12"  # displays 12 lines before search results with / and ?
fi

# kvm default connection
export VIRSH_DEFAULT_CONNECT_URI='qemu:///system'

# autosuggetions
export ZSH_AUTOSUGGEST_HIGHLIGHT_STYLE="fg=10"
export ZSH_AUTOSUGGEST_USE_ASYNC=1

# OS Name
export OS_NAME="$(uname)"

if [ "$OS_NAME" = "Darwin" ]; then
  eval $(/opt/homebrew/bin/brew shellenv)
fi
